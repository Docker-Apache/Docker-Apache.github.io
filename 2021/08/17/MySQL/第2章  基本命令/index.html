

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="浮梁华生">
  <meta name="keywords" content="">
  <title>基本命令 - 浮梁华生</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"docker-apache.github.io","root":"/","version":"1.8.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>浮梁华生</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/img.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="基本命令">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-08-17 13:09" pubdate>
        2021年8月17日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.5k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      118
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">基本命令</h1>
            
            <div class="markdown-body">
              <h2 id="2-1-数据库语言（增删改查-CRUD）"><a href="#2-1-数据库语言（增删改查-CRUD）" class="headerlink" title="2.1 数据库语言（增删改查 CRUD）"></a>2.1 数据库语言（增删改查 CRUD）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">DDL		-- 定义<br>DML		-- 操作<br>DQL		-- 查询<br>DCL		-- 控制<br></code></pre></td></tr></table></figure>

<p>每个表必须包含 5 个字段，保证一个字段存在的意义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">id      	-- 主键<br>version 	-- 乐观锁<br>is_delete	-- 伪删除<br>gmt_create	-- 创建时间<br>gmt_update	-- 修改时间<br></code></pre></td></tr></table></figure>

<h2 id="2-2-数据库"><a href="#2-2-数据库" class="headerlink" title="2.2 数据库"></a>2.2 数据库</h2><p>MySQL 关键字不区分大小写，<code>[]</code> 是可选语句</p>
<h4 id="1-创建"><a href="#1-创建" class="headerlink" title="1. 创建"></a>1. 创建</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">create databases [if not exists] home;	<br></code></pre></td></tr></table></figure>

<h4 id="2-删除"><a href="#2-删除" class="headerlink" title="2.  删除"></a>2.  删除</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">drop databases [if exists] home;<br></code></pre></td></tr></table></figure>

<h4 id="3-使用"><a href="#3-使用" class="headerlink" title="3. 使用"></a>3. 使用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">use home;		-- 使用 &#96;home&#96;，数据库名可以是关键字，例如 use &#96;user&#96;;<br></code></pre></td></tr></table></figure>

<h4 id="4-查看"><a href="#4-查看" class="headerlink" title="4. 查看"></a>4. 查看</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs `mysql">show databases;<br></code></pre></td></tr></table></figure>

<h2 id="2-3-数据库表"><a href="#2-3-数据库表" class="headerlink" title="2.3 数据库表"></a>2.3 数据库表</h2><h3 id="2-3-1-创建"><a href="#2-3-1-创建" class="headerlink" title="2.3.1 创建"></a>2.3.1 创建</h3><p><img src="https://e.im5i.com/2021/08/25/3G4BG.png" srcset="/img/loading.gif" alt="Table"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE IF NOT EXISTS &#96;student&#96; (<br>	&#96;id&#96; INT(4) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT &#39;学号&#39;,<br>	&#96;name&#96; VARCHAR(30) NOT NULL DEFAULT &#39;华生&#39; COMMENT &#39;姓名&#39;,<br>	&#96;password&#96; VARCHAR(20) NOT NULL DEFAULT &#39;123&#39; COMMENT &#39;密码&#39;,<br>	&#96;sex&#96; VARCHAR(2) NOT NULL DEFAULT &#39;男&#39; COMMENT &#39;性别&#39;,<br>	&#96;birthday&#96; DATETIME DEFAULT NULL COMMENT &#39;出生日期&#39;,<br>	&#96;address&#96; VARCHAR(100) DEFAULT NULL COMMENT &#39;家庭地址&#39;,<br>	&#96;email&#96; VARCHAR(50) DEFAULT NULL COMMENT &#39;邮箱&#39;,<br>	PRIMARY KEY (&#96;id&#96;)<br>) ENGINE&#x3D;INNODB DEFAULT CHARSET&#x3D;utf8<br><br>SHOW CREATE DATABASE shcool;		-- 查看创建数据库的语句<br>SHOW CREATE TABLE student;			-- 查看创建表的语句<br>DESC student;						-- 查看表的结构<br></code></pre></td></tr></table></figure>

<p><img src="https://e.im5i.com/2021/08/25/3GInY.png" srcset="/img/loading.gif" alt="Output"></p>
<h3 id="2-3-2-引擎"><a href="#2-3-2-引擎" class="headerlink" title="2.3.2 引擎"></a>2.3.2 引擎</h3><table>
<thead>
<tr>
<th></th>
<th>MyISAM（MySQL 5.5 之前）</th>
<th>InnoDB（现在的默认引擎）</th>
</tr>
</thead>
<tbody><tr>
<td>事务</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>数据行锁定</td>
<td>不支持</td>
<td>支持行锁</td>
</tr>
<tr>
<td>外键约束</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>全文索引</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>表空间大小</td>
<td>小</td>
<td>大，约为 2 倍</td>
</tr>
</tbody></table>
<ul>
<li>MyISAM：节约空间、速度快</li>
<li>InnoDB：安全性高、事务的处理、多表多用户操作</li>
</ul>
<h3 id="2-3-3-数据库的文件结构"><a href="#2-3-3-数据库的文件结构" class="headerlink" title="2.3.3 数据库的文件结构"></a>2.3.3 数据库的文件结构</h3><p>对于 Win，所有数据库都在 data 目录下，一个文件夹对应一个数据库</p>
<p>InnoDB</p>
<ul>
<li><code>.frm</code> 文件</li>
<li>上级目录中的 <code>ibdata1</code> 文件</li>
</ul>
<p>MyISAM</p>
<ul>
<li><code>.frm</code>：表结构的定义文件</li>
<li><code>.MYD</code>：数据文件 data</li>
<li><code>.MYI</code>：索引文件 index</li>
</ul>
<h3 id="2-3-4-操作"><a href="#2-3-4-操作" class="headerlink" title="2.3.4 操作"></a>2.3.4 操作</h3><h4 id="1-修改"><a href="#1-修改" class="headerlink" title="1. 修改"></a>1. 修改</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">ALTER TABLE student RENAME AS student1;			-- 重命名表名<br>ALTER TABLE student1 ADD age INT(10);			-- 增加字段<br><br>ALTER TABLE student1 MODIFY age VARCHAR(10);	-- 修改约束<br>ALTER TABLE student1 CHANGE age age1 INT(10);	-- 重命名字段<br><br>ALTER TABLE student1 DROP age1;					-- 删除字段<br></code></pre></td></tr></table></figure>

<h4 id="2-删除-1"><a href="#2-删除-1" class="headerlink" title="2. 删除"></a>2. 删除</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">DROP TABLE IF EXISTS runoob_tbl;<br></code></pre></td></tr></table></figure>

<h2 id="2-3-数据管理"><a href="#2-3-数据管理" class="headerlink" title="2.3 数据管理"></a>2.3 数据管理</h2><h3 id="2-3-1-外键"><a href="#2-3-1-外键" class="headerlink" title="2.3.1 外键"></a>2.3.1 外键</h3><p>阿里 Java 规范</p>
<blockquote>
<p>【强制】不得使用外键与级联，一切外键概念必须在应用层解决</p>
</blockquote>
<p>原因</p>
<blockquote>
<p>每次做 delete 或者 update 都必须考虑外键约束，会导致开发的时候很痛苦,测试数据极为不方便</p>
</blockquote>
<p>下面是两种物理外键：数据库级别的外键，不建议使用（了解即可）</p>
<p>法一：创建表时增加外键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 删除 grade 表（主表）之前，必须先删除 student 表（从表）<br>CREATE TABLE &#96;grade&#96; (<br>	&#96;gradeID&#96; INT(10) NOT NULL AUTO_INCREMENT COMMENT &#39;年级id&#39;,<br>	&#96;gradeName&#96; VARCHAR(50) NOT NULL COMMENT &#39;年级名称&#39;,<br>	PRIMARY KEY (&#96;gradeID&#96;)<br>) ENGINE&#x3D;INNODB DEFAULT CHARSET&#x3D;utf8;	-- ; 号不能少<br><br>-- 学生表的 gradeID 字段引用年级表的 gradeID<br>-- 1. 定义外键 FK_gradeID<br>-- 2. 给 FK_gradeID 添加约束（执行引用）<br>CREATE TABLE IF NOT EXISTS &#96;student&#96; (<br>	&#96;id&#96; INT(4) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT &#39;学号&#39;,<br>	&#96;name&#96; VARCHAR(30) NOT NULL DEFAULT &#39;华生&#39; COMMENT &#39;姓名&#39;,<br>	&#96;password&#96; VARCHAR(20) NOT NULL DEFAULT &#39;123&#39; COMMENT &#39;密码&#39;,<br>	&#96;sex&#96; VARCHAR(2) NOT NULL DEFAULT &#39;男&#39; COMMENT &#39;性别&#39;,<br>	&#96;birthday&#96; DATETIME DEFAULT NULL COMMENT &#39;出生日期&#39;,<br>	&#96;gradeID&#96; INT(10) NOT NULL COMMENT &#39;年级id&#39;,	-- 不能是 AUTO_INCREMENT，一个表中只能有一个 AUTO_INCREMENT<br>	&#96;address&#96; VARCHAR(100) DEFAULT NULL COMMENT &#39;家庭地址&#39;,<br>	&#96;email&#96; VARCHAR(50) DEFAULT NULL COMMENT &#39;邮箱&#39;,<br>	PRIMARY KEY (&#96;id&#96;),<br>	KEY &#96;FK_gradeID&#96; (&#96;gradeID&#96;),<br>	CONSTRAINT &#96;FK_gradeID&#96; FOREIGN KEY (&#96;gradeID&#96;) REFERENCES &#96;grade&#96;(&#96;gradeID&#96;)<br>) ENGINE&#x3D;INNODB DEFAULT CHARSET&#x3D;utf8;<br></code></pre></td></tr></table></figure>

<p>法二：创建表时不增加外键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE IF NOT EXISTS &#96;grade&#96; (<br>	&#96;gradeID&#96; INT(10) NOT NULL AUTO_INCREMENT COMMENT &#39;年级id&#39;,<br>	&#96;gradeName&#96; VARCHAR(50) NOT NULL COMMENT &#39;年级名称&#39;,<br>	PRIMARY KEY (&#96;gradeID&#96;)<br>) ENGINE&#x3D;INNODB DEFAULT CHARSET&#x3D;utf8;<br><br>-- 创建表时不增加外键<br>CREATE TABLE IF NOT EXISTS &#96;student&#96; (<br>	&#96;id&#96; INT(4) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT &#39;学号&#39;,<br>	&#96;name&#96; VARCHAR(30) NOT NULL DEFAULT &#39;华生&#39; COMMENT &#39;姓名&#39;,<br>	&#96;password&#96; VARCHAR(20) NOT NULL DEFAULT &#39;123&#39; COMMENT &#39;密码&#39;,<br>	&#96;sex&#96; VARCHAR(2) NOT NULL DEFAULT &#39;男&#39; COMMENT &#39;性别&#39;,<br>	&#96;birthday&#96; DATETIME DEFAULT NULL COMMENT &#39;出生日期&#39;,<br>	&#96;gradeID&#96; INT(10) NOT NULL COMMENT &#39;年级id&#39;,<br>	&#96;address&#96; VARCHAR(100) DEFAULT NULL COMMENT &#39;家庭地址&#39;,<br>	&#96;email&#96; VARCHAR(50) DEFAULT NULL COMMENT &#39;邮箱&#39;,<br>	PRIMARY KEY (&#96;id&#96;)<br>) ENGINE&#x3D;INNODB DEFAULT CHARSET&#x3D;utf8;<br><br>-- 增加外键<br>ALTER TABLE &#96;student&#96; ADD CONSTRAINT &#96;FK_gradeID&#96; FOREIGN KEY(&#96;gradeID&#96;) REFERENCES &#96;grade&#96;(&#96;gradeID&#96;);<br></code></pre></td></tr></table></figure>

<h3 id="2-3-2-DML-语言（记）"><a href="#2-3-2-DML-语言（记）" class="headerlink" title="2.3.2 DML 语言（记）"></a>2.3.2 DML 语言（记）</h3><p>DML（Data Manipulation Language）</p>
<h4 id="1-插入"><a href="#1-插入" class="headerlink" title="1. 插入"></a>1. 插入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 单字段，单值<br>INSERT INTO &#96;grade&#96;(&#96;gradeName&#96;) VALUES (&#39;大四&#39;);				-- id 自增，可以省略<br><br>-- 单字段，多值<br>INSERT INTO &#96;grade&#96;(&#96;gradeName&#96;) VALUES (&#39;大一&#39;), (&#39;大二&#39;);<br><br>-- 多字段，多值<br>INSERT INTO &#96;student&#96;(&#96;name&#96;, &#96;password&#96;, &#96;sex&#96;) VALUES (&#39;浮梁&#39;, &#39;123456&#39;, &#39;男&#39;), (&#39;Apache&#39;, &#39;666666&#39;, &#39;女&#39;);<br><br>-- 可以省略字段，但必须与所有字段一一对应<br>INSERT INTO &#96;student&#96; VALUES (100, &#39;浮梁&#39;, &#39;123456&#39;, &#39;男&#39;, &#39;2021-08-29&#39;, &#39;101&#39;, &#39;东莞&#39;, &#39;email&#39;);<br><br>-- 错误，必须保证字段和值一一对应<br>INSERT INTO &#96;grade&#96; VALUES (&#39;大四&#39;);<br></code></pre></td></tr></table></figure>

<h4 id="2-更新"><a href="#2-更新" class="headerlink" title="2. 更新"></a>2. 更新</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 带条件<br>UPDATE &#96;student&#96; SET &#96;name&#96;&#x3D;&#39;Docker&#39; WHERE id &#x3D; 1;				 	-- 等于<br>UPDATE &#96;student&#96; SET &#96;name&#96;&#x3D;&#39;Docker000&#39; WHERE id !&#x3D; 1;				-- 不等于，也可以使用 &lt;&gt;<br>UPDATE &#96;student&#96; SET &#96;birthday&#96;&#x3D;CURRENT_TIME WHERE id &gt; 2;			-- 设置变量<br>UPDATE &#96;student&#96; SET &#96;name&#96;&#x3D;&#39;Docker111&#39; WHERE id BETWEEN 1 AND 3;	-- [1, 3]<br><br>-- 不带条件，修改所有<br>UPDATE &#96;student&#96; SET &#96;name&#96;&#x3D;&#39;Spark&#39;;<br><br>-- 多字段<br>UPDATE &#96;student&#96; SET &#96;name&#96;&#x3D;&#39;Apache&#39;, &#96;password&#96;&#x3D;&#39;0xffff&#39; WHERE id &lt;&#x3D; 100;<br><br>-- 多条件<br>UPDATE &#96;student&#96; SET &#96;name&#96;&#x3D;&#39;张三&#39; WHERE &#96;name&#96;&#x3D;&#39;Hadoop&#39; AND &#96;sex&#96;&#x3D;&#39;女&#39;;<br>UPDATE &#96;student&#96; SET &#96;name&#96;&#x3D;&#39;张三&#39; WHERE &#96;name&#96;&#x3D;&#39;Hadoop&#39; OR &#96;sex&#96;&#x3D;&#39;女&#39;;<br></code></pre></td></tr></table></figure>

<h4 id="3-删除"><a href="#3-删除" class="headerlink" title="3. 删除"></a>3. 删除</h4><p>（1）delete 和 truncate 的异同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE &#96;test&#96; (<br>	&#96;id&#96; INT(4) NOT NULL AUTO_INCREMENT,<br>	&#96;coll&#96; VARCHAR(20) NOT NULL,<br>	PRIMARY KEY (&#96;id&#96;)<br>) ENGINE&#x3D;INNODB DEFAULT CHARSET&#x3D;utf8;<br><br>INSERT INTO &#96;test&#96;(&#96;coll&#96;) VALUES (&#39;1&#39;),(&#39;2&#39;);<br><br>DELETE FROM &#96;test&#96; WHERE &#96;id&#96; &#x3D; 1;<br>DELETE FROM &#96;test&#96;;		-- AUTO_INCREMENT 不清零<br>TRUNCATE TABLE &#96;test&#96;;	-- AUTO_INCREMENT 清零<br></code></pre></td></tr></table></figure>

<ul>
<li>同：都能删除数据，不删除表结构（保留字段名）</li>
<li>异：<code>truncate</code> 自增变量 <code>auto_increment</code> 清零，不会影响事务；<code>delete</code> 不清零（不重启）</li>
</ul>
<p>（2）delete 的注意事项</p>
<ul>
<li>使用 InnoDB 引擎：<code>auto_increment</code> 重启后清零，因为变量存在内存中（未持久化）</li>
<li>使用 MyISAM 引擎：<code>auto_increment</code> 重启不清零，因为变量存在文件中</li>
</ul>
<h3 id="2-3-3-DQL-查询（最重要）"><a href="#2-3-3-DQL-查询（最重要）" class="headerlink" title="2.3.3 DQL 查询（最重要）"></a>2.3.3 DQL 查询（最重要）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE DATABASE IF NOT EXISTS &#96;school&#96;;<br>USE &#96;school&#96;;<br><br>-- 学生<br>DROP TABLE IF EXISTS &#96;student&#96;;<br>CREATE TABLE &#96;student&#96; (<br>    &#96;StudentNum&#96; INT(4) NOT NULL COMMENT &#39;学号&#39;,<br>    &#96;Password&#96; VARCHAR(20) DEFAULT NULL COMMENT &#39;登录密码&#39;,<br>    &#96;StudentName&#96; VARCHAR(20) DEFAULT NULL COMMENT &#39;姓名&#39;,<br>    &#96;Sex&#96; TINYINT(1) DEFAULT NULL COMMENT &#39;性别，0或1&#39;,<br>    &#96;GradeID&#96; INT(11) DEFAULT NULL COMMENT &#39;年级编号&#39;,<br>    &#96;Phone&#96; VARCHAR(50) NOT NULL COMMENT &#39;联系电话，允许为空&#39;,<br>    &#96;Address&#96; VARCHAR(255) NOT NULL COMMENT &#39;地址，允许为空&#39;,<br>    &#96;Birthday&#96; DATETIME DEFAULT NULL COMMENT &#39;出生日期&#39;,<br>    &#96;Email&#96; VARCHAR (50) NOT NULL COMMENT &#39;邮箱账号允许为空&#39;,<br>    &#96;IDCard&#96; VARCHAR(18) DEFAULT NULL COMMENT &#39;身份证号&#39;,<br>    PRIMARY KEY (&#96;StudentNum&#96;),<br>    UNIQUE KEY &#96;IDCard&#96;(&#96;IDCard&#96;),<br>    KEY &#96;Email&#96;(&#96;Email&#96;)<br>) ENGINE &#x3D; MYISAM DEFAULT CHARSET &#x3D; utf8;<br><br>INSERT INTO &#96;student&#96;(&#96;StudentNum&#96;, &#96;Password&#96;, &#96;StudentName&#96;, &#96;Sex&#96;, &#96;GradeID&#96;, &#96;Phone&#96;, &#96;Address&#96;, &#96;Birthday&#96;, &#96;Email&#96;,&#96;IDCard&#96;) VALUES<br>    (1000, &#39;123456&#39;, &#39;张伟&#39;, 0 , 2, &#39;13800001234&#39;, &#39;北京&#39;, &#39;1980-1-31&#39;, &#39;text123@qq.com&#39;, &#39;123456198001011234&#39;),<br>    (1001, &#39;123456&#39;, &#39;中二&#39;, 1 , 3, &#39;13800002222&#39;, &#39;广东&#39;, &#39;1990-1-25&#39;, &#39;text111@qq.com&#39;, &#39;123456199009576867&#39;),<br>    (1002, &#39;666666&#39;, &#39;张大江&#39;, 0 , 2, &#39;13800001654&#39;, &#39;四川&#39;, &#39;1998-2-1&#39;, &#39;text666@qq.com&#39;, &#39;123456198008765867&#39;),<br>    (1003, &#39;000000&#39;, &#39;张三&#39;, 0 , 1, &#39;13800001111&#39;, &#39;四川&#39;, &#39;2000-7-28&#39;, &#39;text922@qq.com&#39;, &#39;123456198008678567&#39;),<br>    (1004, &#39;222222&#39;, &#39;李四&#39;, 1 , 4, &#39;13800006666&#39;, &#39;广东&#39;, &#39;2001-6-14&#39;, &#39;text156@qq.com&#39;, &#39;123456199006747456&#39;),<br>    (1005, &#39;555555&#39;, &#39;王五&#39;, 0 , 4, &#39;13800008888&#39;, &#39;上海&#39;, &#39;2010-4-29&#39;, &#39;text234@qq.com&#39;, &#39;123456198004535235&#39;);<br><br><br><br>-- 年级<br>DROP TABLE IF EXISTS &#96;grade&#96;;<br>CREATE TABLE &#96;grade&#96; (<br>	&#96;GradeID&#96; INT(11) NOT NULL AUTO_INCREMENT COMMENT &#39;年级编号&#39;,<br>	&#96;GradeName&#96; VARCHAR(50) NOT NULL COMMENT &#39;年级名称&#39;,<br>    PRIMARY KEY (&#96;GradeID&#96;)<br>) ENGINE &#x3D; INNODB AUTO_INCREMENT &#x3D; 6 DEFAULT CHARSET &#x3D; utf8;<br><br>INSERT INTO &#96;grade&#96;(&#96;GradeID&#96;,&#96;GradeName&#96;) VALUES<br>    (1, &#39;大一&#39;),<br>    (2, &#39;大二&#39;),<br>    (3, &#39;大三&#39;),<br>    (4, &#39;大四&#39;);<br><br><br>-- 课程<br>DROP TABLE IF EXISTS &#96;subject&#96;;<br>CREATE TABLE &#96;subject&#96; (<br>	&#96;SubjectNum&#96;INT(11) NOT NULL AUTO_INCREMENT COMMENT &#39;课程编号&#39;,<br>    &#96;SubjectName&#96; VARCHAR(50) DEFAULT NULL COMMENT &#39;课程名称&#39;,<br>    &#96;ClassHour&#96; INT(4) DEFAULT NULL COMMENT &#39;学时&#39;,<br>    &#96;GradeID&#96; INT(4) DEFAULT NULL COMMENT &#39;年级编号&#39;,<br>    PRIMARY KEY (&#96;SubjectNum&#96;)<br>) ENGINE &#x3D; INNODB AUTO_INCREMENT &#x3D; 18 DEFAULT CHARSET &#x3D; utf8;   -- 课程编号最大为 17<br><br>INSERT INTO &#96;subject&#96;(&#96;SubjectNum&#96;, &#96;SubjectName&#96;, &#96;ClassHour&#96;, &#96;GradeID&#96;) VALUES<br>    (1, &#39;高等数学-1&#39;, 110,1),<br>    (2, &#39;高等数学-2&#39;, 110,2),<br>    (3, &#39;高等数学-3&#39;, 100,3),<br>    (4, &#39;高等数学-4&#39;, 130,4),<br>    (5, &#39;C语言-1&#39;, 110,1),<br>    (6, &#39;C语言-2&#39;, 110,2),<br>    (7, &#39;C语言-3&#39;, 100,3),<br>    (8, &#39;C语言-4&#39;, 130,4),<br>    (9, &#39;Java程序设计-1&#39;, 110,1),<br>    (10, &#39;Java程序设计-2&#39;, 110,2),<br>    (11, &#39;Java程序设计-3&#39;, 100,3),<br>    (12, &#39;Java程序设计-4&#39;, 130,4),<br>    (13, &#39;数据库结构-1&#39;, 110,1),<br>    (14, &#39;数据库结构-2&#39;, 110,2),<br>    (15, &#39;数据库结构-3&#39;, 100,3),<br>    (16, &#39;数据库结构-4&#39;, 130,4),<br>    (17, &#39;C#基础&#39;, 130,1);<br><br><br>-- 成绩<br>DROP TABLE IF EXISTS &#96;score&#96;;<br>CREATE TABLE &#96;score&#96; (<br>	&#96;StudentNum&#96; INT(4) NOT NULL COMMENT &#39;学号&#39;,<br>    &#96;SubjectNum&#96; INT(4) NOT NULL COMMENT &#39;课程编号&#39;,<br>    &#96;ExamData&#96; DATETIME NOT NULL COMMENT &#39;考试日期&#39;,<br>    &#96;Score&#96; INT (4) NOT NULL COMMENT &#39;考试成绩&#39;,<br>    KEY &#96;SubjectNum&#96; (&#96;SubjectNum&#96;)<br>) ENGINE &#x3D; INNODB DEFAULT CHARSET &#x3D; utf8;<br><br>INSERT INTO &#96;score&#96;(&#96;StudentNum&#96;, &#96;SubjectNum&#96;, &#96;ExamData&#96;, &#96;Score&#96;) VALUES<br>    (1000, 1, &#39;2013-11-11 16:00:00&#39;, 85),<br>    (1000, 2, &#39;2013-11-12 16:00:00&#39;, 70),<br>    (1000, 5, &#39;2013-11-13 09:00:00&#39;, 68),<br>        <br>    (1001, 4, &#39;2015-11-11 16:00:00&#39;, 90),<br>    (1001, 5, &#39;2015-11-12 16:00:00&#39;, 85),<br>    (1001, 7, &#39;2015-11-13 09:00:00&#39;, 55),<br><br>    (1002, 5, &#39;2015-11-11 16:00:00&#39;, 99),<br>    (1002, 2, &#39;2015-11-12 16:00:00&#39;, 75),<br>    (1002, 8, &#39;2015-11-13 09:00:00&#39;, 95),<br><br>    (1003, 5, &#39;2015-11-11 16:00:00&#39;, 60),<br>    (1003, 9, &#39;2015-11-12 16:00:00&#39;, 88),<br>    (1003, 14, &#39;2015-11-13 09:00:00&#39;, 69),<br><br>    (1004, 17, &#39;2015-11-11 16:00:00&#39;, 80),<br>    (1004, 5, &#39;2015-11-12 16:00:00&#39;, 76),<br>    (1004, 8, &#39;2015-11-13 09:00:00&#39;, 66),<br>    <br>    (1005, 1, &#39;2015-11-11 16:00:00&#39;, 99),<br>    (1005, 5, &#39;2015-11-12 16:00:00&#39;, 84),<br>    (1005, 3, &#39;2015-11-13 09:00:00&#39;, 82);<br></code></pre></td></tr></table></figure>

<h4 id="1-select"><a href="#1-select" class="headerlink" title="1. select"></a>1. select</h4><p>模板</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT [ALL | DISTINCT]<br>	* | table.* | [table.field1 [AS alias1], table.field2 [AS alias2], ...]<br>FROM table_name [AS table_alias]<br>	[LEFT | RIGHT | INNER JOIN Table1 ON Table2]	-- 连接查询，Table1 连接 Table2<br>	[WHERE ...]										-- 条件<br>	[GROUP BY ...]									-- 分组<br>	[HAVING ...]									-- 分组条件，与 where 一样，只是位置不同<br>	[ORDER BY ...]									-- 排序<br>	[LIMIT begPos len]								-- 查询从第 begPos（从 0 开始） 开始的 len 条记录<br></code></pre></td></tr></table></figure>

<p>（1）实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM student;                              					-- 查询全部学生<br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96; FROM &#96;student&#96;;   					-- 查询全部学生的学号和姓名<br>SELECT &#96;StudentNum&#96; AS 学号, &#96;StudentName&#96; AS 姓名 FROM &#96;student&#96; AS s;   -- 取别名<br>SELECT CONCAT(&#39;姓名：&#39;, &#96;StudentName&#96;) AS 新名字 FROM &#96;student&#96;;  	     -- Concat(a, b) 函数<br></code></pre></td></tr></table></figure>

<p>（2）去重</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT &#96;StudentNum&#96; FROM &#96;score&#96;;<br>SELECT DISTINCT &#96;StudentNum&#96; FROM &#96;score&#96;;	-- 去重，哪些同学参加了考试（有成绩）<br></code></pre></td></tr></table></figure>

<p>（3）表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT VERSION();					-- 数据库版本<br>SELECT 100 * 2 - 1;					-- 计算表达式<br>SELECT @@auto_increment_increment;  -- 变量：自增步长<br><br>-- 所有成绩都 +1<br>SELECT &#96;StudentNum&#96;, &#96;Score&#96; + 1 AS 提分后 FROM &#96;score&#96;;<br></code></pre></td></tr></table></figure>

<h4 id="2-where"><a href="#2-where" class="headerlink" title="2. where"></a>2. where</h4><p>（1）逻辑运算符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">AND   &amp;&amp;<br>OR    ||<br>NOT   !&#x3D;<br></code></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 区间<br>SELECT &#96;StudentNum&#96;, &#96;Score&#96; FROM &#96;score&#96; WHERE &#96;Score&#96; &gt;&#x3D; 90 AND &#96;Score&#96; &lt;&#x3D; 100;<br>SELECT &#96;StudentNum&#96;, &#96;Score&#96; FROM &#96;score&#96; WHERE &#96;Score&#96; BETWEEN 90 AND 100;<br><br>-- 除了 1000 号之外的成绩<br>SELECT &#96;StudentNum&#96;, &#96;Score&#96; FROM &#96;score&#96; WHERE &#96;StudentNum&#96; !&#x3D; 1000;<br>SELECT &#96;StudentNum&#96;, &#96;Score&#96; FROM &#96;score&#96; WHERE NOT &#96;StudentNum&#96; &#x3D; 1000;<br></code></pre></td></tr></table></figure>

<p>（2）模糊查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">a IS NULL				-- a 为 NULL<br>a IS NOT NULL			-- a 不为 NULL<br>a BETWEEN b AND C		-- a 在 [b, c]<br>a Like b				-- a 匹配 b<br>a In (a1, a2, a3)		-- a 在 (a1, a2, a3) 中<br></code></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- ---------------- LIKE -----------------<br><br>-- 查询 “张” 姓同学<br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96; FROM &#96;student&#96; WHERE &#96;StudentName&#96; LIKE &#39;张%&#39;;    -- % 表示任意个字符<br><br>-- 查询 “张” 姓的两字同学<br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96; FROM &#96;student&#96; WHERE &#96;StudentName&#96; LIKE &#39;张_&#39;;    -- _ 表示一个字符<br><br>-- 查询 “张” 姓的三字同学<br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96; FROM &#96;student&#96; WHERE &#96;StudentName&#96; LIKE &#39;张__&#39;;<br><br>-- 查询名字中有 “大” 的同学<br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96; FROM &#96;student&#96; WHERE &#96;StudentName&#96; LIKE &#39;%大%&#39;;<br><br><br>-- ---------------- IN -----------------<br><br>-- 查询 1000, 1001 号同学<br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96; FROM &#96;student&#96; WHERE &#96;StudentNum&#96; IN (1000, 1001);<br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96; FROM &#96;student&#96; WHERE &#96;StudentNum&#96; &#x3D; 1000 OR &#96;StudentNum&#96; &#x3D; 1001;<br><br>-- 查询地址为空 <br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96; FROM &#96;student&#96; WHERE &#96;Address&#96; &#x3D; &#39;&#39; OR &#96;Address&#96; IS NULL;<br><br>-- 查询有出生日期的同学（is not null）<br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96; FROM &#96;student&#96; WHERE &#96;Birthday&#96; IS NOT NULL;<br></code></pre></td></tr></table></figure>

<h4 id="3-连接查询"><a href="#3-连接查询" class="headerlink" title="3.  连接查询"></a>3.  连接查询</h4><p><img src="https://e.im5i.com/2021/09/03/A0YeM.png" srcset="/img/loading.gif" alt="7 种 join"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;** 基本思路<br> 1. 确定字段分别来自哪些表<br> 2. 确定使用哪种查询？（7 种）<br> 3. 哪些字段是各表中共有的？<br> *&#x2F;<br> <br>-- Join On 连接查询<br>-- Where   等值查询<br><br>-- 1. 查询参加了考试的同学（学号，姓名，科目编号，分数）<br><br>&#x2F;**<br> 学号：    student, score<br> 姓名：    student<br> 科目编号：score<br> 分数：    score <br> *&#x2F;<br><br>-- Inner Join<br>-- StudentNum 是 student 和 socre 中共有的，必须指定一个，如 s.StudentNum<br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;, &#96;SubjectNum&#96;, &#96;Score&#96;<br>FROM &#96;student&#96; AS s<br>INNER JOIN &#96;score&#96; AS r<br>ON s.StudentNum &#x3D; r.StudentNum; -- 也可以用 where<br><br>-- Right Join（返回右表 r 中的所有 StudentNum，即使左表 s 中没有匹配项）<br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;, &#96;SubjectNum&#96;, &#96;Score&#96;<br>FROM student s                          -- 可以省略 AS<br>RIGHT JOIN score r<br>ON r.&#96;StudentNum&#96; &#x3D; s.&#96;StudentNum&#96;;<br><br>-- Left Join（返回左表 s 中的所有 StudentNum，即使右表 r 中没有匹配项）<br>-- 仍然显示未参加考试的同学：小明<br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;, &#96;SubjectNum&#96;, &#96;Score&#96;<br>FROM student s<br>LEFT JOIN score r<br>ON s.&#96;StudentNum&#96; &#x3D; r.&#96;StudentNum&#96;;<br><br>-- 查询缺考的同学（student 中包含了所有的同学，应使用 Left Join）<br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;, &#96;SubjectNum&#96;, &#96;Score&#96;<br>FROM student s<br>LEFT JOIN score r<br>ON s.&#96;StudentNum&#96; &#x3D; r.&#96;StudentNum&#96;<br>WHERE &#96;score&#96; IS NULL;<br><br><br>-- 2. 查询参加了考试的同学（学号，姓名，科目名，分数）<br><br>&#x2F;**<br> 学号：  student, score<br> 姓名：  student<br> 科目名：subject（通过 SubjectNum 连接 [subject, score] 得到 SubjectName）<br> 分数：  score <br> *&#x2F;<br><br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;, &#96;SubjectName&#96;, &#96;Score&#96;<br>FROM &#96;student&#96; s<br>RIGHT JOIN &#96;score&#96; r<br>ON r.&#96;StudentNum&#96; &#x3D; s.&#96;StudentNum&#96;     -- StudentNum 在 score, subject 中<br>INNER JOIN &#96;subject&#96; sub<br>ON r.&#96;SubjectNum&#96; &#x3D; sub.&#96;SubjectNum&#96;;<br><br>-- 3. 查询同学所属的年级（学号，学生姓名，年级名称）<br>SELECT &#96;StudentName&#96;, &#96;GradeName&#96;<br>FROM &#96;student&#96; s<br>INNER JOIN &#96;grade&#96; g<br>ON s.&#96;GradeID&#96; &#x3D; g.&#96;GradeID&#96;;<br><br>-- 4. 查询科目所属的年级（科目名称，年级名称）<br>SELECT &#96;SubjectName&#96;, &#96;GradeName&#96;<br>FROM &#96;subject&#96; sub<br>INNER JOIN &#96;grade&#96; g<br>ON sub.&#96;GradeID&#96; &#x3D; g.&#96;GradeID&#96;;<br><br>-- 5. 查询参加 [高等数学] 考试的同学信息（学号，学生姓名，科目名，分数）<br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;, &#96;SubjectName&#96;, &#96;Score&#96;<br>FROM &#96;student&#96; s<br>INNER JOIN &#96;score&#96; r<br>ON s.&#96;StudentNum&#96; &#x3D; r.&#96;StudentNum&#96;<br>INNER JOIN &#96;subject&#96; sub<br>ON r.&#96;SubjectNum&#96; &#x3D; sub.&#96;SubjectNum&#96;<br>WHERE &#96;SubjectName&#96; LIKE &#39;高等数学-_&#39;;<br></code></pre></td></tr></table></figure>

<p><strong>自链接</strong></p>
<p>核心：一张表拆成两张一样的表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs mysql">DROP TABLE IF EXISTS &#96;category&#96;;<br>CREATE TABLE &#96;category&#96; (<br>	&#96;CategoryID&#96; INT(10) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT &#39;类别 ID&#39;,<br>    &#96;PID&#96; INT(10) NOT NULL COMMENT &#39;父 ID&#39;,<br>    &#96;CategoryName&#96; VARCHAR(50) NOT NULL COMMENT &#39;类别名&#39;,<br>    PRIMARY KEY (&#96;CategoryID&#96;)<br>) ENGINE &#x3D; INNODB AUTO_INCREMENT &#x3D; 9 DEFAULT CHARSET &#x3D; utf8;<br><br>INSERT INTO &#96;category&#96; (&#96;CategoryID&#96;, &#96;PID&#96;, &#96;CategoryName&#96;)<br>VALUES<br>    (2, 1, &#39;信息技术&#39;),<br>    (3, 1, &#39;软件开发&#39;),<br>    (4, 3, &#39;数据库&#39;),<br>    (5, 1, &#39;美术设计&#39;),<br>    (6, 3, &#39;Web 开发&#39;),<br>    (7, 5, &#39;PS 技术&#39;),<br>    (8, 2, &#39;办公信息&#39;);<br>    <br>    <br>SELECT father.&#96;CategoryName&#96; AS &#39;Father&#39;, son.&#96;CategoryName&#96; AS &#39;Son&#39;<br>FROM &#96;category&#96; AS father, &#96;category&#96; AS son<br>WHERE father.&#96;CategoryID&#96; &#x3D; son.&#96;PID&#96;<br></code></pre></td></tr></table></figure>

<p>父类</p>
<table>
<thead>
<tr>
<th>CategoryID</th>
<th>CategoryName</th>
</tr>
</thead>
<tbody><tr>
<td>2</td>
<td>信息技术</td>
</tr>
<tr>
<td>3</td>
<td>软件开发</td>
</tr>
<tr>
<td>5</td>
<td>美术设计</td>
</tr>
</tbody></table>
<p>子类</p>
<table>
<thead>
<tr>
<th>PID</th>
<th>CategoryID</th>
<th>CategoryName</th>
</tr>
</thead>
<tbody><tr>
<td>3</td>
<td>4</td>
<td>数据库</td>
</tr>
<tr>
<td>2</td>
<td>8</td>
<td>办公信息</td>
</tr>
<tr>
<td>3</td>
<td>6</td>
<td>Web 开发</td>
</tr>
<tr>
<td>5</td>
<td>7</td>
<td>PS 技术</td>
</tr>
</tbody></table>
<p>查询父类对应的子类关系</p>
<table>
<thead>
<tr>
<th>Father</th>
<th>Son</th>
</tr>
</thead>
<tbody><tr>
<td>信息技术</td>
<td>办公信息</td>
</tr>
<tr>
<td>软件开发</td>
<td>数据库</td>
</tr>
<tr>
<td>软件开发</td>
<td>Web 开发</td>
</tr>
<tr>
<td>美术设计</td>
<td>PS 技术</td>
</tr>
</tbody></table>
<h4 id="4-分页和排序"><a href="#4-分页和排序" class="headerlink" title="4. 分页和排序"></a>4. 分页和排序</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 排序：升序 ASC，降序 DESC<br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;, &#96;SubjectName&#96;, &#96;Score&#96;<br>FROM &#96;student&#96; s<br>INNER JOIN &#96;score&#96; r<br>ON s.&#96;StudentNum&#96; &#x3D; r.&#96;StudentNum&#96;<br>INNER JOIN &#96;subject&#96; sub<br>ON r.&#96;SubjectNum&#96; &#x3D; sub.&#96;SubjectNum&#96;<br>WHERE sub.&#96;SubjectName&#96; LIKE &#39;高等数学-_&#39;<br>ORDER BY &#96;score&#96; DESC;<br><br>-- 分页，每页只显示 5 条数据<br><br>&#x2F;**<br> 第1页：limit 0, 5 (pageSize &#x3D; 5)<br> 第2页：limit 5, 5<br> 第n页：limit (n-1) *5, 5<br><br> 当前页：n<br> 页面大小: pageSize<br> 总页数: n * pageSize<br> *&#x2F;<br><br>-- 查询高等数学排名前 3 且分数 &gt;&#x3D; 90 的同学信息（学号，学生姓名，课程名称，分数）<br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;, &#96;SubjectName&#96;, &#96;Score&#96;<br>FROM &#96;student&#96; s<br>INNER JOIN &#96;score&#96; r<br>ON s.&#96;StudentNum&#96; &#x3D; r.&#96;StudentNum&#96;<br>INNER JOIN &#96;subject&#96; sub<br>ON r.&#96;SubjectNum&#96; &#x3D; sub.&#96;SubjectNum&#96;<br>WHERE sub.&#96;SubjectName&#96; LIKE &#39;高等数学-_&#39; AND &#96;score&#96; &gt;&#x3D; 90<br>ORDER BY &#96;score&#96; DESC<br>LIMIT 0, 3;              -- 从第 0 个数据开始后的 3 条数据<br></code></pre></td></tr></table></figure>

<h4 id="5-子查询"><a href="#5-子查询" class="headerlink" title="5. 子查询"></a>5. 子查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 1. 查询参加 [高等数学-1] 考试的同学信息（学号，科目编号，分数）<br>-- 法一：连接查询<br>SELECT &#96;StudentNum&#96;, r.&#96;StudentNum&#96;, &#96;Score&#96;<br>FROM &#96;score&#96; r<br>INNER JOIN &#96;subject&#96; sub<br>ON r.&#96;SubjectNum&#96; &#x3D; sub.&#96;SubjectNum&#96;<br>WHERE sub.&#96;SubjectName&#96; &#x3D; &#39;高等数学-1&#39;<br>ORDER BY &#96;score&#96; DESC;<br><br>-- 法二：子查询<br>SELECT &#96;StudentNum&#96;, &#96;StudentNum&#96;, &#96;Score&#96;<br>FROM &#96;score&#96;<br>WHERE &#96;SubjectNum&#96; &#x3D; (<br>    SELECT &#96;SubjectNum&#96;<br>    FROM &#96;subject&#96;<br>    WHERE &#96;SubjectName&#96; &#x3D; &#39;高等数学-1&#39;<br>)<br>ORDER BY &#96;score&#96; DESC;<br><br><br>-- 2. 查询 [高等数学-1] 分数不小于 80 分的学生信息（学号，学生姓名）<br>-- 子查询 1<br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;<br>FROM &#96;student&#96; s<br>INNER JOIN &#96;score&#96; r<br>ON r.&#96;StudentNum&#96; &#x3D; s.&#96;StudentNum&#96;<br>WHERE &#96;score&#96; &gt;&#x3D; 80 AND &#96;SubjectNum&#96; &#x3D; (<br>    SELECT &#96;SubjectNum&#96;<br>    FROM &#96;subject&#96;<br>    WHERE &#96;SubjectName&#96; &#x3D; &#39;高等数学-1&#39;<br>);<br><br>-- 子查询 2<br>SELECT &#96;StudentNum&#96;, &#96;StudentName&#96;<br>FROM &#96;student&#96;<br>WHERE &#96;StudentNum&#96;<br>IN (<br>    SELECT &#96;StudentNum&#96; FROM &#96;score&#96; WHERE &#96;Score&#96; &gt;&#x3D; 80 AND &#96;SubjectNum&#96; &#x3D; (<br>       SELECT &#96;SubjectNum&#96; FROM &#96;subject&#96; WHERE &#96;SubjectName&#96; &#x3D; &#39;高等数学-1&#39;<br>    )<br>);<br><br>-- 3. 查询 [C语言-1] 前 3 名学生的信息（学号，学生姓名，分数）<br>SELECT s.&#96;StudentNum&#96;, &#96;StudentName&#96;, &#96;Score&#96;<br>FROM &#96;student&#96; s<br>INNER JOIN &#96;score&#96; r<br>ON s.&#96;StudentNum&#96; &#x3D; r.&#96;StudentNum&#96;<br>WHERE &#96;SubjectNum&#96; &#x3D; (<br>    SELECT &#96;SubjectNum&#96; FROM &#96;subject&#96; WHERE &#96;SubjectName&#96; &#x3D; &#39;C语言-1&#39;<br>)<br>ORDER BY &#96;score&#96; DESC<br>LIMIT 0, 3;<br></code></pre></td></tr></table></figure>

<h3 id="2-3-4-MySQL-函数"><a href="#2-3-4-MySQL-函数" class="headerlink" title="2.3.4 MySQL 函数"></a>2.3.4 MySQL 函数</h3><p>（1）count 函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs mysql">count(*)    -- 包括所有列，返回表中的记录数，相当于统计表的行数，不忽略值为 NULL 的记录<br><br>count(1)    -- 忽略所有列，1 表示一个固定值，也可以用 count(2)、count(3) 代替，不忽略值为 NULL 的记录<br><br>count(列名)  -- 只包括列名指定列，返回指定列的记录数，在统计结果的时候，会忽略列值为NULL的记录（不包括空字符串和0），即列值为NULL的记录不统计在内<br><br>（4）count(distinct 列名) -- 只包括列名指定列，返回指定列的不同值的记录数，在统计结果的时候，在统计结果的时候，会忽略列值为NULL的记录（不包括空字符串和0），即列值为NULL的记录不统计在内<br><br>3.count(*)&amp;count(1)&amp;count(列名)执行效率比较：<br><br>（1）如果列为主键，count(列名)效率优于count(1)<br><br>（2）如果列不为主键，count(1)效率优于count(列名)<br><br>（3）如果表中存在主键，count(主键列名)效率最优<br><br>（4）如果表中只有一列，则count(*)效率最优<br><br>（5）如果表有多列，且不存在主键，则count(1)效率优于count(*)<br> <br><br>4.因为count(*)和count(1)统计过程中不会忽略列值为NULL的记录，所以可以通过以下两种方式来统计列值为NULL的记录数:<br><br>（1）select count(*) from table where is_active is null;<br>（2）select count(1) from table where is_active is null;<br><br><br>5.特例：<br><br>（1）select count(&#39;&#39;) from table;-返回表的记录数<br>（2）select count(0) from table;-返回表的记录数<br>（3）select count(null) from table;-返回0<br></code></pre></td></tr></table></figure>

<p>聚合函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT SUM(&#96;Score&#96;) AS 总和 FROM &#96;score&#96;;<br>SELECT AVG(&#96;Score&#96;) AS 平均分 FROM &#96;score&#96;;<br>SELECT MAX(&#96;Score&#96;) AS 最高分 FROM &#96;score&#96;;<br>SELECT MIN(&#96;Score&#96;) AS 最低分 FROM &#96;score&#96;;<br><br>-- 查询不同课程的（平均分，最高分，最低分）平均分 &gt; 80<br>-- 考点：根据不同的课程分组<br>SELECT &#96;SubjectName&#96;, AVG(&#96;Score&#96;) AS 平均分, MAX(&#96;Score&#96;) AS 最高分, MIN(&#96;Score&#96;) AS 最低分<br>FROM &#96;score&#96; r<br>INNER JOIN &#96;subject&#96; sub<br>ON r.&#96;SubjectNum&#96; &#x3D; sub.&#96;SubjectNum&#96;<br>GROUP BY r.&#96;SubjectNum&#96;                 -- 分组<br>HAVING 平均分 &gt; 80                       -- 分组条件<br></code></pre></td></tr></table></figure>

<h2 id="2-4-事务"><a href="#2-4-事务" class="headerlink" title="2.4 事务"></a>2.4 事务</h2><h3 id="ACID-原则"><a href="#ACID-原则" class="headerlink" title="ACID 原则"></a>ACID 原则</h3><p>原子性 Atomicity（不可分割性）：要么都成功，要么都失败</p>
<p>一致性 Consistency：总数不变</p>
<p>隔离性 Isolation（独立性）：多个进程互补干扰</p>
<p>持久性（Durability）：提交后不可逆，持久化到数据库</p>
<h3 id="隔离性的问题"><a href="#隔离性的问题" class="headerlink" title="隔离性的问题"></a>隔离性的问题</h3><p>脏读：一个事务读取了另一个没有提交的事务</p>
<p>不可重复读：在同一个事务中，重复读取表中的数据，数据发生了改变</p>
<p>虚读（幻读）：在同一个事物中，读取了别人插入的数据，导致前后读取的结果不一致</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- MySQL 默认开启事务自动提交<br>SET autocommit &#x3D; 0  -- 关闭事务<br>SET autocommit &#x3D; 1  -- 开启事务（默认）<br><br><br>-- 手动处理事务<br>SET autocommit &#x3D; 0<br><br>-- 事务，后面的 sql 都在该事务中<br>START TRANSACTION      <br> <br>INSERT xx<br><br>COMMIT      -- 提交，持久化（成功）<br><br>ROLLBACK    -- 回滚（失败）<br><br>-- 事务结束<br>SET autocommit &#x3D; 1  -- 开启自动提交<br><br><br>-- 了解<br>SAVEPOINT 保存点名                  -- 设置一个事务的保存点<br>ROLLBACK TO SAVEPOINT 保存点名      -- 回滚到保存点<br>RELEASE SAVEPOINT 保存点名          -- 撤销保存点<br></code></pre></td></tr></table></figure>

<p>模拟转账：事务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE DATABASE IF NOT EXISTS &#96;school&#96;;<br>USE &#96;school&#96;;<br>CREATE TABLE &#96;account&#96; (<br>    &#96;id&#96; INT(3) NOT NULL AUTO_INCREMENT,<br>    &#96;name&#96; VARCHAR(30) NOT NULL,<br>    &#96;money&#96; DECIMAL(9, 2) NOT NULL,<br>    PRIMARY KEY (&#96;id&#96;)<br>) ENGINE &#x3D; INNODB DEFAULT CHARSET &#x3D; utf8;<br><br>INSERT INTO &#96;account&#96;(&#96;name&#96;, &#96;money&#96;) VALUES<br>    (&#39;A&#39;, 2000.00),<br>    (&#39;B&#39;, 10000.00);<br><br><br>-- 模拟转账：事务<br>SET autocommit &#x3D; 0;     -- 关闭自动提交<br>START TRANSACTION<br><br>UPDATE &#96;account&#96; SET &#96;money&#96; &#x3D; &#96;money&#96; - 500 WHERE &#96;name&#96; &#x3D; &#39;A&#39;;<br>UPDATE &#96;account&#96; SET &#96;money&#96; &#x3D; &#96;money&#96; + 500 WHERE &#96;name&#96; &#x3D; &#39;B&#39;;<br><br>&#x2F;** 提交事务后，事务被持久化<br> * 1. 回滚只能回到提交后的状态 A:1500, B:10500<br> * 2. 若不提交，直接回滚到 A:2000, B:10000<br> *&#x2F;<br>COMMIT;     -- 手动提交事务<br><br>ROLLBACK;   -- 回滚<br><br>SET autocommit &#x3D; 1;     -- 开启自动提交<br></code></pre></td></tr></table></figure>

<h2 id="2-5-索引"><a href="#2-5-索引" class="headerlink" title="2.5 索引"></a>2.5 索引</h2><h3 id="2-5-1-索引的分类"><a href="#2-5-1-索引的分类" class="headerlink" title="2.5.1 索引的分类"></a>2.5.1 索引的分类</h3><p>在一个表中，主键索引只能有一个，唯一索引可以有多个</p>
<table>
<thead>
<tr>
<th>索引</th>
<th>关键字</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>主键索引</td>
<td>Primary Key</td>
<td>唯一的标识，主键索引只能有一个</td>
</tr>
<tr>
<td>唯一索引</td>
<td>Unique Key</td>
<td>避免重复的列出现，唯一索引可以有多个</td>
</tr>
<tr>
<td>常规索引</td>
<td>Key/Index</td>
<td>默认索引</td>
</tr>
<tr>
<td>全文索引</td>
<td>FullText</td>
<td>特定的数据库引擎才有</td>
</tr>
</tbody></table>
<h2 id="2-6-权限管理和备份"><a href="#2-6-权限管理和备份" class="headerlink" title="2.6 权限管理和备份"></a>2.6 权限管理和备份</h2><h3 id="2-6-1-权限管理"><a href="#2-6-1-权限管理" class="headerlink" title="2.6.1 权限管理"></a>2.6.1 权限管理</h3><p>对用户权限的修改本质是对表 mysql.user 进行修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- 创建用户<br>CREATE USER Docker IDENTIFIED BY &#39;111&#39;;<br><br>-- 删除用户<br>DROP USER Docker;<br><br>-- 修改密码（当前用户）<br>SET PASSWORD &#x3D; PASSWORD(&#39; &#39;);<br><br>-- 修改密码（指定用户）<br>SET PASSWORD FOR Docker &#x3D; PASSWORD(&#39;999&#39;);<br><br>-- 重命名<br>RENAME USER Docker TO Apache;<br><br>-- 用户授权<br>-- ALL PRIVILEGES：给所有库的所有表授权（除了给别人授权的 grant 权限）<br>GRANT ALL PRIVILEGES ON *.* TO Apache;<br><br>-- 查看权限<br>SHOW GRANTS FOR Apache;<br>SHOW GRANTS FOR root@localhost;<br><br>-- 撤销权限<br>REVOKE ALL PRIVILEGES ON *.* FROM Apache;<br></code></pre></td></tr></table></figure>

<h3 id="2-6-2-备份"><a href="#2-6-2-备份" class="headerlink" title="2.6.2 备份"></a>2.6.2 备份</h3><p>作用：避免数据丢失；数据转移</p>
<p>备份方式</p>
<ul>
<li>直接备份物理文件；data 文件</li>
<li>在 SQLyog 中右键「数据库/表」，选择「备份/导出」</li>
<li>使用命令行 mysqldump</li>
</ul>
<h2 id="2-7-数据库设计三大范式"><a href="#2-7-数据库设计三大范式" class="headerlink" title="2.7 数据库设计三大范式"></a>2.7 数据库设计三大范式</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/72197799">知乎文章</a></p>
<p>目前关系型数据库有六种范式：第一范式（1NF）、第二范式（2NF）、第三范式（3NF）、巴斯-科德范式（BCNF）、第四范式（4NF）和第五范式（5NF，又称完美范式）。一般来说，数据库只需要满足第三范式就行了</p>
<h3 id="第一范式：保证每列的原子性"><a href="#第一范式：保证每列的原子性" class="headerlink" title="第一范式：保证每列的原子性"></a>第一范式：保证每列的原子性</h3><p>例如「地址」一列的字段：广东省东莞市 xxx 路 xxx 号。不能将该地址作为一个整体的字段，因为若频繁查询地址属于哪个省，那个市，则还需将查询到的地址再切片，<strong>不能做到所查即所得</strong></p>
<p>正确的做法是将地址再切分为多个字段：省（广东省）、市（东莞市）、详细地址（xxx 路 xxx 号），保证每一列都不可再分（原子性）</p>
<h3 id="第二范式：保证一张表只描述一件事情"><a href="#第二范式：保证一张表只描述一件事情" class="headerlink" title="第二范式：保证一张表只描述一件事情"></a>第二范式：保证一张表只描述一件事情</h3><h3 id="第三范式：保证每列都和主键直接相关"><a href="#第三范式：保证每列都和主键直接相关" class="headerlink" title="第三范式：保证每列都和主键直接相关"></a>第三范式：保证每列都和主键直接相关</h3><h3 id="规范与性能之间的平衡"><a href="#规范与性能之间的平衡" class="headerlink" title="规范与性能之间的平衡"></a>规范与性能之间的平衡</h3><p>关联查询的表不得超过三个（阿里）</p>
<ul>
<li>考虑商业化的需求和目标（成本、用户体验），数据库的性能更加重要</li>
<li>故意增加一些冗余字段（多表查询 -&gt; 单表查询）</li>
<li>故意增加一些计算列（索引）</li>
</ul>
<h2 id="2-8-JDBC（重点）"><a href="#2-8-JDBC（重点）" class="headerlink" title="2.8 JDBC（重点）"></a>2.8 JDBC（重点）</h2><p>Java 数据库连接 JDBC（Java Database Connectivity）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;<br>        <span class="hljs-comment">// 1. 加载驱动</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br><br>        <span class="hljs-comment">// 2. 连接数据库 student</span><br>        String url = <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/school?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=true&quot;</span>;<br>        String userName = <span class="hljs-string">&quot;root&quot;</span>;<br>        String password = <span class="hljs-string">&quot;0000&quot;</span>;<br>        <br>        <span class="hljs-comment">// connection 代表数据库，可以进行事务操作（事务提交、事务回滚）</span><br>        Connection connection = DriverManager.getConnection(url, userName, password);<br><br>        <span class="hljs-comment">/* 3. 执行 SQL 对象 statement，获得结果集 resultSet</span><br><span class="hljs-comment">           statement.execute();        // 执行任何 sql</span><br><span class="hljs-comment">           statement.executeUpdate();  // 更新、插入、删除。返回受影响的行数</span><br><span class="hljs-comment">           statement.executeBatch();   // 执行多个 sql</span><br><span class="hljs-comment">         */</span><br>        Statement statement = connection.createStatement();<br>        ResultSet resultSet = statement.executeQuery(<span class="hljs-string">&quot;select * from score&quot;</span>);<br><br>        System.out.println(<span class="hljs-string">&quot;StudentNum\tSubjectNum\tExamData\t\t\t\tScore&quot;</span>);<br>        <span class="hljs-keyword">while</span> (resultSet.next()) &#123;<br>            System.out.print(resultSet.getObject(<span class="hljs-string">&quot;StudentNum&quot;</span>) + <span class="hljs-string">&quot;\t\t&quot;</span>);<br>            System.out.print(resultSet.getObject(<span class="hljs-string">&quot;SubjectNum&quot;</span>) + <span class="hljs-string">&quot;\t\t\t&quot;</span>);<br>            System.out.print(resultSet.getObject(<span class="hljs-string">&quot;ExamData&quot;</span>) + <span class="hljs-string">&quot;\t&quot;</span>);<br>            System.out.println(resultSet.getObject(<span class="hljs-string">&quot;Score&quot;</span>));<br>        &#125;<br><br>        <span class="hljs-comment">// 4. 释放连接（必须）</span><br>        resultSet.close();<br>        statement.close();<br>        connection.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="增删改查-CRUD"><a href="#增删改查-CRUD" class="headerlink" title="增删改查 CRUD"></a>增删改查 CRUD</h3><p>配置文件 db.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">driver</span> = <span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">url</span> = <span class="hljs-string">jdbc:mysql://localhost:3306/school?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=true</span><br><span class="hljs-attr">userName</span> = <span class="hljs-string">root</span><br><span class="hljs-attr">password</span> = <span class="hljs-string">0000</span><br></code></pre></td></tr></table></figure>

<p>核心类 <code>JdbcUtils</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcUtils</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String driver = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String url = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String userName = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String password = <span class="hljs-keyword">null</span>;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 反射，加载配置文件 db.properties </span><br>            InputStream inputStream = JdbcUtils.class.getClassLoader().getResourceAsStream(<span class="hljs-string">&quot;db.properties&quot;</span>);<br>            Properties properties = <span class="hljs-keyword">new</span> Properties();<br>            properties.load(inputStream);<br><br>            driver = properties.getProperty(<span class="hljs-string">&quot;driver&quot;</span>);<br>            url = properties.getProperty(<span class="hljs-string">&quot;url&quot;</span>);<br>            userName = properties.getProperty(<span class="hljs-string">&quot;userName&quot;</span>);<br>            password = properties.getProperty(<span class="hljs-string">&quot;password&quot;</span>);<br><br>            <span class="hljs-comment">// 加载驱动</span><br>            Class.forName(driver);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 获取连接</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title">getConnection</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">return</span> DriverManager.getConnection(url, userName, password);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 释放连接</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release</span><span class="hljs-params">(Connection conn, Statement st, ResultSet res)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">if</span> (res != <span class="hljs-keyword">null</span>) &#123;<br>            res.close();<br>        &#125;<br>        <span class="hljs-keyword">if</span> (st != <span class="hljs-keyword">null</span>) &#123;<br>            st.close();<br>        &#125;<br>        <span class="hljs-keyword">if</span> (conn != <span class="hljs-keyword">null</span>) &#123;<br>            conn.close();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>CRUD</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/** CRUD</span><br><span class="hljs-comment"> * 增加 Create、检索 Retrieve、更新 Update、删除 Delete</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Crud</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> Connection connection = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">static</span> Statement statement = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">static</span> ResultSet resultSet = <span class="hljs-keyword">null</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(String sql)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            connection = JdbcUtils.getConnection();<br>            statement = connection.createStatement();<br><br>            <span class="hljs-keyword">int</span> i = statement.executeUpdate(sql);<br>            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;已插入 &quot;</span> + i + <span class="hljs-string">&quot; 行数据&quot;</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            JdbcUtils.release(connection, statement, resultSet);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">(String sql)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            connection = JdbcUtils.getConnection();<br>            statement = connection.createStatement();<br><br>            <span class="hljs-keyword">int</span> i = statement.executeUpdate(sql);<br>            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;已删除 &quot;</span> + i + <span class="hljs-string">&quot; 行数据&quot;</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            JdbcUtils.release(connection, statement, resultSet);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(String sql)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            connection = JdbcUtils.getConnection();<br>            statement = connection.createStatement();<br><br>            <span class="hljs-keyword">int</span> i = statement.executeUpdate(sql);<br>            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;已更新 &quot;</span> + i + <span class="hljs-string">&quot; 行数据&quot;</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            JdbcUtils.release(connection, statement, resultSet);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">select</span><span class="hljs-params">(String sql)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            connection = JdbcUtils.getConnection();<br>            statement = connection.createStatement();<br>            resultSet = statement.executeQuery(sql);<br><br>            System.out.println(<span class="hljs-string">&quot;StudentNum\tStudentName\tSubjectName\t\tScore&quot;</span>);<br>            <span class="hljs-keyword">while</span> (resultSet.next()) &#123;<br>                System.out.print(resultSet.getObject(<span class="hljs-string">&quot;StudentNum&quot;</span>) + <span class="hljs-string">&quot;\t\t&quot;</span>);<br>                System.out.print(resultSet.getObject(<span class="hljs-string">&quot;StudentName&quot;</span>) + <span class="hljs-string">&quot;\t\t\t&quot;</span>);<br>                System.out.print(resultSet.getObject(<span class="hljs-string">&quot;SubjectName&quot;</span>) + <span class="hljs-string">&quot;\t\t&quot;</span>);<br>                System.out.println(resultSet.getObject(<span class="hljs-string">&quot;Score&quot;</span>));<br>            &#125;<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            JdbcUtils.release(connection, statement, resultSet);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-comment">// 插入多行数据时，「,」号不能省</span><br>        String sqlInsert = <span class="hljs-string">&quot;insert into `score`(`StudentNum`, `SubjectNum`, `ExamData`, `Score`) values&quot;</span> +<br>                <span class="hljs-string">&quot;(1010, 2, &#x27;2013-11-09 16:00:00&#x27;, 100),&quot;</span> +<br>                <span class="hljs-string">&quot;(1011, 6, &#x27;2013-10-09 16:00:00&#x27;, 98),&quot;</span> +<br>                <span class="hljs-string">&quot;(1012, 8, &#x27;2013-12-09 16:00:00&#x27;, 95);&quot;</span>;<br><span class="hljs-comment">//        insert(sqlInsert);</span><br><br>        <span class="hljs-comment">// 删除</span><br>        String sqlDelete = <span class="hljs-string">&quot;delete from `score` where `StudentNum` = 1010&quot;</span>;<br><span class="hljs-comment">//        delete(sqlDelete);</span><br><br>        <span class="hljs-comment">// 更新</span><br>        String sqlUpdate = <span class="hljs-string">&quot;update `score` set `StudentNum` = 1018, `Score` = 10 &quot;</span> +<br>                <span class="hljs-string">&quot;where `StudentNum` = 1011 or `StudentNum` = 1012&quot;</span>;<br><span class="hljs-comment">//        update(sqlUpdate);</span><br><br>        <span class="hljs-comment">// 查询，直接把 sql 语句复制过来，不要删 \n</span><br>        String sqlSelect = <span class="hljs-string">&quot;SELECT s.`StudentNum`, `StudentName`, `SubjectName`, `Score`\n&quot;</span> +<br>                <span class="hljs-string">&quot;FROM `student` s\n&quot;</span> +<br>                <span class="hljs-string">&quot;INNER JOIN `score` r\n&quot;</span> +<br>                <span class="hljs-string">&quot;ON r.`StudentNum` = s.`StudentNum`\n&quot;</span> +<br>                <span class="hljs-string">&quot;INNER JOIN `subject` sub\n&quot;</span> +<br>                <span class="hljs-string">&quot;ON r.`SubjectNum` = sub.`SubjectNum`;&quot;</span>;<br>        select(sqlSelect);<br>    &#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-9-SQL-注入漏洞"><a href="#2-9-SQL-注入漏洞" class="headerlink" title="2.9 SQL 注入漏洞"></a>2.9 SQL 注入漏洞</h2><p>sql 使用非法拼接，导致数据泄露</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/MySQL/">MySQL</a>
                    
                  </div>
                
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/10/10/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/1%20%E5%9B%9E%E6%BA%AF/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">1 递归与回溯</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/07/27/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/5%20%E4%BA%8C%E5%8F%89%E6%A0%91/">
                        <span class="hidden-mobile">5 位运算</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js" ></script>

  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



</body>
</html>
